pep-push-common
===============

Proper Enterprise Platform

实现了 `pep-push-api` 中的公共内容

##消息推送流程参考
1. 业务端通过http方式，根据推送平台提供的接口，将“推送请求”推送服服务平台。
2. 推送服务器的webcontroller收到业务端的推送请求后，将“推送请求”加入到统一的消息队列中（JMS实现）。
3. 消息队列接收者从消息队列中取出“推送请求”，调用实际的推送服务类，推送消息。
4. 推送服务类根据消息的请求，查找用户与设备的对应关系，查找出要推送消息的设备相关信息。
5. 推送服务类遍历要推送的消息的设备信息，首先将推送的消息缓存到数据库中，然后调用实际的推送SDK(华为推送，小米推送，苹果推送，根据相关的设备信息可知具体的推送相关信息)向客户端推送消息，并根据SDK返回的结果设置数据库中缓存的消息的推送状态（推送成功还是失败）
6. 对应推送失败的消息，推送平台会启用定时任务重新推送消息，累计发送到一定次数后将不再推送。
7. 系统会定期删除数据库中指定天数之前的缓存的消息记录

## 配置文件参考

-  `conf/push/common/pushConfigs.js` 
推送相关的统一的配置信息，因为配置的信息比较复杂，简单的properties文件满足不了要求，所以主要采用js的json格式来保存配置
使用`Nutz`框架相关的接口来读取这个文件，获取相关的配置信息。
具体的详细配置方法可以看pushConfigs.js中对应的注释

- `conf/push/common/vendor/apns/keystores`
ios推送sdk对应的推送.p12证书保存的目录,需要根据不同的项目设置不同的推送证书

- `conf/huawei/common/vendor/apns/keystores`
华为推送sdk对应的推送证书保存的目录，与ios推送证书不同，所有的项目可共用一个证书，所以不用配置

  
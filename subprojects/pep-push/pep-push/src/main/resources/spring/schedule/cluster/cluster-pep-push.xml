<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:util="http://www.springframework.org/schema/util"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
                           http://www.springframework.org/schema/beans/spring-beans.xsd
                           http://www.springframework.org/schema/util
                           http://www.springframework.org/schema/util/spring-util.xsd">

    <util:list id="pepJobListPush">
        <!-- 检查未发送的消息定时任务 -->
        <bean id="pushClearOldMsgsScheduleTrigger" class="org.springframework.scheduling.quartz.CronTriggerFactoryBean">
            <property name="jobDetail">
                <bean class="com.proper.enterprise.platform.schedule.cluster.PEPMethodInvokingJobDetailFactoryBean">
                    <property name="targetBeanName" value="checkUnsendMsgsTask"/>
                    <property name="targetMethod" value="saveCheckUnsendMsgs" />
                    <property name="concurrent" value="false"/>
                </bean>
            </property>
            <property name="cronExpression" value="0 0/15 * * * ?"/>
        </bean>
        <!-- 清空指定天数之前的发送成功消息定时任务 -->
        <bean id="pushClearOldMsgsScheduleTrigger" class="org.springframework.scheduling.quartz.CronTriggerFactoryBean">
            <property name="jobDetail">
                <bean class="com.proper.enterprise.platform.schedule.cluster.PEPMethodInvokingJobDetailFactoryBean">
                    <property name="targetBeanName" value="clearOldMsgsTask"/>
                    <property name="targetMethod" value="deleteOldMsgs" />
                    <property name="concurrent" value="false"/>
                </bean>
            </property>
            <property name="cronExpression" value="0 0 23 * * ?"/>
        </bean>
        <!-- 清空指定天数之前的发送失败消息定时任务 -->
        <bean id="pushClearOldUnsendMsgsScheduleTrigger" class="org.springframework.scheduling.quartz.CronTriggerFactoryBean">
            <property name="jobDetail">
                <bean class="com.proper.enterprise.platform.schedule.cluster.PEPMethodInvokingJobDetailFactoryBean">
                    <property name="targetBeanName" value="clearOldMsgsTask"/>
                    <property name="targetMethod" value="deleteOldUnsendMsgs" />
                    <property name="concurrent" value="false"/>
                </bean>
            </property>
            <property name="cronExpression" value="0 0 23 * * ?"/>
        </bean>
        <!-- 每日消息统计任务 -->
        <bean id="saveMsgStatisticInfoScheduleTrigger" class="org.springframework.scheduling.quartz.CronTriggerFactoryBean">
            <property name="jobDetail">
                <bean class="com.proper.enterprise.platform.schedule.cluster.PEPMethodInvokingJobDetailFactoryBean">
                    <property name="targetBeanName" value="pushStatisticTask"/>
                    <property name="targetMethod" value="saveYesterdayPushStatistic" />
                    <property name="concurrent" value="false"/>
                </bean>
            </property>
            <property name="cronExpression" value="0 0 3 * * ?"/>
        </bean>
    </util:list>
</beans>

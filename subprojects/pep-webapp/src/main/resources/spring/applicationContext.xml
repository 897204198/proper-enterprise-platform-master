<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:context="http://www.springframework.org/schema/context"
       xmlns:mvc="http://www.springframework.org/schema/mvc"
       xmlns:jdbc="http://www.springframework.org/schema/jdbc"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
                           http://www.springframework.org/schema/beans/spring-beans-4.1.xsd
                           http://www.springframework.org/schema/context
                           http://www.springframework.org/schema/context/spring-context-4.1.xsd
                           http://www.springframework.org/schema/mvc
                           http://www.springframework.org/schema/mvc/spring-mvc-4.1.xsd
                           http://www.springframework.org/schema/jdbc
                           http://www.springframework.org/schema/jdbc/spring-jdbc-4.1.xsd"
       default-autowire="byName">

    <import resource="classpath*:spring/**/applicationContext-*.xml" />

    <!-- Auto scan beans -->
    <context:component-scan base-package="com.proper" />

    <mvc:annotation-driven />

    <!--
    其他模块（如 pep-workflow）中有 auth 模块的 sql 时，如果不忽略 sql 执行失败，会导致测试无法通过
    如果设置为不忽略 sql 执行失败，则可能需要该模块依赖权限模块，而这个依赖可能是非必须的
    先将忽略失败设置为 ALL，等待集成测试基类 AbstractTest 重构后再修改
    TODO
    -->
    <jdbc:initialize-database data-source="dataSource" ignore-failures="ALL">
        <jdbc:script location="classpath*:sql/users.sql"/>
        <jdbc:script location="classpath*:sql/roles.sql"/>
        <jdbc:script location="classpath*:sql/resources.sql"/>
        <jdbc:script location="classpath*:sql/users-roles.sql"/>
        <jdbc:script location="classpath*:sql/roles-resources.sql"/>
    </jdbc:initialize-database>

</beans>
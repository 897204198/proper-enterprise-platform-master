buildscript {
    repositories {
        jcenter()
    }
    dependencies {
        classpath libraries.tomcat_plugin
    }
}
apply plugin: 'com.bmuschko.tomcat'
apply plugin: 'eclipse-wtp'
apply plugin: 'war'

ext {
    tomcatContextPath = 'pep'
    tomcatHttpPort = 8080
    tomcatStopPort = 8081
    tomcatStopKey = 'stopKey'
}

tomcat.httpPort = tomcatHttpPort
tomcatRun.contextPath = tomcatContextPath

dependencies {
    // tomcat plugin dependencies
    tomcat libraries.tomcat
    providedRuntime libraries.servlet_api

    compile project(':pep-auth-common')
    
    testCompile project(':pep-test')

    runtime libraries.h2,
            libraries.hibernate_ehcache,
            libraries.hibernate_hikaricp,
            libraries.spring_context_support,
            libraries.spring_orm,
            libraries.spring_webmvc
}

task integTomcatRun(type: com.bmuschko.gradle.tomcat.tasks.TomcatRun) {
    contextPath = tomcatContextPath
    stopPort = tomcatStopPort
    stopKey = tomcatStopKey
    daemon = true
}

task integTomcatStop(type: com.bmuschko.gradle.tomcat.tasks.TomcatStop) {
    stopPort = tomcatStopPort
    stopKey = tomcatStopKey
}

//task integTest(type: Test) {
//    include '**/*IntegTest.*'
//    //dependsOn integTomcatRun
//    //finalizedBy integTomcatStop
//}


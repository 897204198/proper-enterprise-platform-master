buildscript {
    repositories {
        maven {
            url "${nexusUrl}/repository/maven-public"
            credentials(PasswordCredentials) {
                username = nexusUsername
                password = nexusPassword
            }
        }
    }
    dependencies {
        classpath 'org.akhikhl.gretty:gretty:1.2.4'
    }
}

apply plugin: 'org.akhikhl.gretty'
apply plugin: 'eclipse-wtp'
apply plugin: 'war'

gretty {
    servletContainer = 'tomcat7'
    contextPath = 'pep'
    debugSuspend = false
    fileLogEnabled = false
    managedClassReload = true
    serverConfigFile = "$rootProject.projectDir/configs/docker/tomcat/server.xml"
}

dependencies {
    runtime project(':pep-auth-jwt'),
            project(':pep-av-backend'),
            project(':pep-configs'),
            project(':pep-workflow'),
            libraries.commons_fileupload,
            libraries.h2,
            libraries.jackson_databind,
            libraries.jaxws_rt,
            libraries.mysql_driver,
            libraries.spring_orm,
            libraries.spring_webmvc
}

task cleanDist(type: Delete) {
    delete 'build/libs'
}

compileJava.dependsOn cleanDist
uploadArchives.deleteAllActions()
